# 属性面板收起/展开功能

## 📋 功能概述

v2.1.0 版本新增了属性面板收起/展开功能，让用户可以根据需要隐藏右侧属性面板，获得更大的画布空间进行设计。

## ✨ 功能特性

### 收起/展开切换
- **一键切换**: 点击面板标题栏的箭头按钮
- **平滑动画**: 0.3秒过渡动画，体验流畅
- **状态记忆**: 收起状态保持，直到手动展开
- **即时反馈**: 状态栏显示当前操作

### UI 变化
- **展开状态**: 320px 宽度，显示完整内容
- **收起状态**: 40px 宽度，仅显示竖向标题
- **图标旋转**: 箭头图标旋转 180° 指示状态
- **内容隐藏**: 收起时自动隐藏所有面板内容

### 视觉效果
- **竖向标题**: 收起时标题竖向显示
- **箭头动画**: 平滑旋转过渡
- **悬停高亮**: 鼠标悬停时图标变色
- **边框保留**: 始终保留边框分隔线

## 🎯 使用方法

### 收起属性面板
1. 找到右侧属性面板的标题栏
2. 点击标题栏右侧的 **箭头按钮** ▶
3. 面板平滑收起到 40px 宽度
4. 状态栏显示"属性面板已收起"

### 展开属性面板
1. 点击收起状态下的 **箭头按钮** ◀
2. 面板平滑展开到 320px 宽度
3. 状态栏显示"属性面板已展开"

### 使用场景

#### 1. 最大化画布空间
```
场景: 设计大型复杂场景
操作: 收起属性面板
效果: 画布增加 280px 宽度
```

#### 2. 专注设计工作
```
场景: 批量创建物体
操作: 收起属性面板
效果: 减少视觉干扰
```

#### 3. 小屏幕适配
```
场景: 使用笔记本电脑
操作: 收起属性面板
效果: 获得更多可用空间
```

#### 4. 演示模式
```
场景: 向他人展示设计
操作: 收起属性面板
效果: 画布内容更加突出
```

#### 5. 预览效果
```
场景: 查看整体布局
操作: 收起属性面板
效果: 全局视野更开阔
```

## 🎨 UI 设计

### 展开状态
```
┌─────────────────────────────────┐
│ 属性面板                    ▶  │ ← 标题栏
├─────────────────────────────────┤
│                                 │
│  🔧 视图设置                    │
│  画布宽度: 1000px              │
│  画布高度: 700px               │
│  ...                            │
│                                 │
│  选中对象属性                   │
│  ...                            │
│                                 │
└─────────────────────────────────┘
      320px 宽度
```

### 收起状态
```
┌─┐
│属│ ← 竖向标题
│性│
│面│
│板│
│ │
│◀│ ← 展开按钮
│ │
└─┘
40px
```

## 🔧 技术实现

### HTML 结构
```html
<div id="property-panel" class="property-panel">
  <div class="panel-header">
    <h3 class="panel-title">属性面板</h3>
    <button id="btn-toggle-panel" class="btn-toggle-panel" title="收起/展开面板">
      <svg width="16" height="16" viewBox="0 0 16 16" class="toggle-icon">
        <path d="M6 4 L10 8 L6 12" fill="none" stroke="currentColor" stroke-width="2"/>
      </svg>
    </button>
  </div>
  
  <div class="panel-content-wrapper">
    <!-- 视图设置 -->
    <!-- 属性内容 -->
  </div>
</div>
```

### CSS 样式
```css
/* 属性面板 */
.property-panel {
  width: 320px;
  transition: width 0.3s ease;
}

/* 收起状态 */
.property-panel.collapsed {
  width: 40px;
}

.property-panel.collapsed .panel-content-wrapper {
  display: none;
}

/* 竖向标题 */
.property-panel.collapsed .panel-title {
  writing-mode: vertical-rl;
  text-orientation: mixed;
}

/* 箭头旋转 */
.property-panel.collapsed .toggle-icon {
  transform: rotate(180deg);
}

/* 按钮样式 */
.btn-toggle-panel {
  background: transparent;
  border: none;
  cursor: pointer;
  transition: color 0.2s;
}

.btn-toggle-panel:hover {
  color: var(--primary-color);
}

/* 图标动画 */
.toggle-icon {
  transition: transform 0.3s ease;
}
```

### TypeScript 逻辑
```typescript
// 添加事件监听
document.getElementById('btn-toggle-panel')?.addEventListener('click', () => {
  this.togglePanel();
});

// 切换面板状态
private togglePanel(): void {
  const panel = document.getElementById('property-panel');
  if (panel) {
    panel.classList.toggle('collapsed');
    const isCollapsed = panel.classList.contains('collapsed');
    this.updateStatus(isCollapsed ? '属性面板已收起' : '属性面板已展开');
  }
}
```

## 📊 实现细节

### 动画时长
- **过渡时间**: 0.3 秒
- **缓动函数**: ease
- **影响属性**: width, transform

### 尺寸规格
- **展开宽度**: 320px（原始宽度）
- **收起宽度**: 40px（仅容纳竖向标题和按钮）
- **标题高度**: 保持不变
- **按钮大小**: 16×16 px

### 响应式处理
```css
/* 标题在不同状态下的样式 */
.panel-title {
  font-size: 16px;           /* 展开状态 */
}

.property-panel.collapsed .panel-title {
  writing-mode: vertical-rl; /* 竖向书写 */
  font-size: 14px;           /* 略小字体 */
}
```

### 图标设计
```svg
<!-- 展开状态：向右箭头 ▶ -->
<path d="M6 4 L10 8 L6 12" />

<!-- 收起状态：通过 CSS transform 旋转 180° 变为向左箭头 ◀ -->
transform: rotate(180deg);
```

## 🧪 测试清单

### 基本功能
- [ ] 点击按钮面板收起
- [ ] 再次点击面板展开
- [ ] 动画平滑无卡顿
- [ ] 状态栏消息正确显示

### UI 测试
- [ ] 收起时内容完全隐藏
- [ ] 展开时内容完整显示
- [ ] 标题正确竖向显示
- [ ] 箭头图标正确旋转
- [ ] 按钮悬停效果正常

### 兼容性测试
- [ ] 收起后可以正常创建物体
- [ ] 收起后选中物体不受影响
- [ ] 收起后物理预览正常
- [ ] 收起后画布操作正常
- [ ] 收起后视图控制仍可用（通过快捷键）

### 边界测试
- [ ] 快速连续点击按钮
- [ ] 动画进行中点击按钮
- [ ] 预览模式下切换面板
- [ ] 有选中对象时收起面板

### 性能测试
- [ ] 动画流畅（60 FPS）
- [ ] 无内存泄漏
- [ ] 多次切换性能稳定

## 💡 使用技巧

### 技巧 1: 快捷键增强（未来）
可以考虑添加键盘快捷键：
```
建议: F2 或 Tab 键切换面板
优势: 无需鼠标操作
```

### 技巧 2: 配合画布缩放
```
场景: 需要最大化工作区域
操作:
  1. 收起属性面板（+280px）
  2. 增大画布尺寸至 2000px
  3. 降低 PPM 显示更大区域
结果: 获得超大设计空间
```

### 技巧 3: 双屏工作流
```
场景: 使用双显示器
操作:
  1. 主屏显示编辑器（收起面板）
  2. 副屏显示属性文档或参考图
结果: 最大化各屏幕利用率
```

### 技巧 4: 演示准备
```
场景: 需要向他人展示设计
准备:
  1. 调整画布到合适大小
  2. 收起属性面板
  3. 重置视图到最佳视角
  4. 启动物理预览
结果: 专业的演示效果
```

## 🎮 键盘快捷键建议（未来实现）

### 可能的快捷键方案
```
F2        → 切换属性面板
Ctrl + B  → 切换属性面板（Browser 风格）
Tab       → 循环切换面板状态
[         → 收起面板
]         → 展开面板
```

### 实现示例
```typescript
document.addEventListener('keydown', (e) => {
  if (e.key === 'F2') {
    e.preventDefault();
    this.togglePanel();
  }
});
```

## 🔮 未来增强

### 可能的改进
- [ ] **记住状态**: 保存到 localStorage
- [ ] **键盘快捷键**: F2 或 Tab 切换
- [ ] **拖动调整**: 拖动边框调整宽度
- [ ] **多面板支持**: 左右两个可收起面板
- [ ] **最小化到图标**: 完全隐藏只留图标

### 高级功能
- [ ] **浮动面板**: 可拖动到任意位置
- [ ] **透明度调整**: 半透明显示在画布上方
- [ ] **自动隐藏**: 鼠标离开自动收起
- [ ] **面板分组**: 不同组别可独立收起

## 📈 用户体验提升

### 之前
```
- 属性面板始终占据 320px
- 小屏幕上画布空间受限
- 无法专注于画布内容
- 演示时界面杂乱
```

### 之后
```
✅ 可按需隐藏属性面板
✅ 最大化画布可用空间
✅ 更清爽的工作界面
✅ 适应不同工作场景
✅ 提升专业感
```

## 📝 代码统计

### 修改文件
```
index.html:  +8 行  (添加面板头和包装器)
styles.css:  +64 行 (面板收起样式和动画)
src/main.ts: +9 行  (togglePanel 方法和事件监听)
总计:        +81 行
```

### 代码位置
```
HTML: index.html 行 125-135
CSS:  styles.css 行 207-270
TS:   src/main.ts 行 279, 403-409
```

## ✅ 功能状态

- ✅ **已实现**: 收起/展开切换
- ✅ **已实现**: 平滑动画过渡
- ✅ **已实现**: 竖向标题显示
- ✅ **已实现**: 图标旋转动画
- ✅ **已实现**: 状态栏反馈
- ✅ **已测试**: 基本功能正常
- ⏳ **待实现**: 键盘快捷键
- ⏳ **待实现**: 状态持久化

## 🎉 总结

属性面板收起/展开功能是一个**小而美**的改进：

- 🎯 **用户需求**: 满足不同场景的空间需求
- 🎨 **视觉优雅**: 平滑动画和合理的视觉设计
- ⚡ **性能优秀**: 轻量级实现，无性能影响
- 🔧 **易于维护**: 简洁的代码结构
- 📱 **响应式**: 适配不同屏幕尺寸

这个功能让用户对工作空间有了更多的**控制权**，提升了整体的**使用体验**！

---

**功能版本**: v2.1.0  
**添加日期**: 2025-10-14  
**状态**: ✅ 生产就绪
