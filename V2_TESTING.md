# V2.0.0 功能测试指南

## 🎯 测试目标

验证 v2.0.0 新增的形状编辑功能和 bug 修复。

## ✅ 测试清单

### 1. 位置和角度编辑（属性面板）⭐ 新增

**测试步骤：**
1. 使用任意工具创建一个形状（矩形/圆形/多边形）
2. 使用选择工具点击选中形状
3. 在右侧属性面板找到"位置坐标"部分
4. 修改"X 坐标"值（例如从 0m 改为 5m）
5. 修改"Y 坐标"值（例如从 0m 改为 3m）
6. 修改"旋转角度"值（例如从 0° 改为 45°）

**预期结果：**
- ✅ 物体立即移动到新位置 (5, 3)
- ✅ 物体旋转 45°
- ✅ 属性面板显示更新后的值
- ✅ 可以使用 Ctrl+Z 撤销修改
- ✅ 可以使用 Ctrl+Y 重做修改
- ✅ 角度输入支持任意值（自动转换为弧度）

---

### 2. 矩形尺寸编辑（属性面板）

**测试步骤：**
1. 使用矩形工具创建一个矩形
2. 使用选择工具点击选中矩形
3. 在右侧属性面板找到"形状尺寸"部分
4. 修改"宽度"值（例如从 2m 改为 5m）
5. 修改"高度"值（例如从 2m 改为 3m）

**预期结果：**
- ✅ 矩形尺寸立即更新
- ✅ 矩形保持中心点位置不变
- ✅ 可以使用 Ctrl+Z 撤销修改
- ✅ 可以使用 Ctrl+Y 重做修改

---

### 2. 矩形尺寸编辑（属性面板）

**测试步骤：**
1. 使用矩形工具创建一个矩形
2. 使用选择工具点击选中矩形
3. 在右侧属性面板找到"矩形尺寸"部分
4. 修改"宽度"值（例如从 2m 改为 5m）
5. 修改"高度"值（例如从 2m 改为 3m）

**预期结果：**
- ✅ 矩形尺寸立即更新
- ✅ 矩形保持中心点位置不变
- ✅ 可以使用 Ctrl+Z 撤销修改
- ✅ 可以使用 Ctrl+Y 重做修改

---

### 3. 圆形半径编辑（属性面板）

**测试步骤：**
1. 使用圆形工具创建一个圆
2. 使用选择工具点击选中圆形
3. 在右侧属性面板找到"形状尺寸"部分
4. 修改"半径"值（例如从 1m 改为 3m）

**预期结果：**
- ✅ 圆形半径立即更新
- ✅ 圆形保持中心点位置不变
- ✅ 可以使用 Ctrl+Z 撤销修改
- ✅ 可以使用 Ctrl+Y 重做修改

---

### 3. 圆形半径编辑（属性面板）

**测试步骤：**
1. 使用圆形工具创建一个圆
2. 使用选择工具点击选中圆形
3. 在右侧属性面板找到"圆形尺寸"部分
4. 修改"半径"值（例如从 1m 改为 3m）

**预期结果：**
- ✅ 圆形半径立即更新
- ✅ 圆形保持中心点位置不变
- ✅ 可以使用 Ctrl+Z 撤销修改
- ✅ 可以使用 Ctrl+Y 重做修改

---

### 4. 多边形顶点编辑（属性面板）

**测试步骤：**
1. 使用多边形工具创建一个三角形或四边形
2. 使用选择工具点击选中多边形
3. 在属性面板滚动到"多边形顶点"部分
4. 修改某个顶点的 X 坐标值
5. 修改某个顶点的 Y 坐标值

**预期结果：**
- ✅ 多边形形状立即更新
- ✅ 输入框显示正确的坐标值（2 位小数）
- ✅ 提示信息显示"顶点坐标相对于物体中心"
- ✅ 可以使用 Ctrl+Z 撤销修改
- ✅ 可以使用 Ctrl+Y 重做修改

---

### 4. 多边形顶点编辑（属性面板）

**测试步骤：**
1. 使用多边形工具创建一个三角形或四边形
2. 使用选择工具点击选中多边形
3. 在属性面板滚动到"多边形顶点"部分
4. 修改某个顶点的 X 坐标值
5. 修改某个顶点的 Y 坐标值

**预期结果：**
- ✅ 多边形形状立即更新
- ✅ 输入框显示正确的坐标值（2 位小数）
- ✅ 提示信息显示"顶点坐标相对于物体中心"
- ✅ 可以使用 Ctrl+Z 撤销修改
- ✅ 可以使用 Ctrl+Y 重做修改

---

### 5. 多边形顶点拖动编辑（画布）⭐ 核心功能

**测试步骤：**
1. 使用多边形工具创建一个多边形（3-6 个顶点）
2. 使用选择工具**双击**多边形

**预期结果（进入编辑模式）：**
- ✅ 状态栏显示"顶点编辑模式"
- ✅ 状态栏显示操作提示："拖动顶点修改位置"
- ✅ 状态栏显示退出提示："双击或点击空白处退出"
- ✅ 所有顶点显示为蓝色圆点（6px）
- ✅ 顶点中心显示白色编号（0, 1, 2...）

**测试步骤（拖动顶点）：**
3. 点击并拖动任意顶点

**预期结果（拖动中）：**
- ✅ 被拖动的顶点变为红色
- ✅ 多边形形状实时跟随鼠标更新
- ✅ 其他顶点保持蓝色

**测试步骤（完成拖动）：**
4. 释放鼠标

**预期结果（拖动完成）：**
- ✅ 顶点保持在新位置
- ✅ 顶点变回蓝色
- ✅ 可以使用 Ctrl+Z 撤销移动
- ✅ 可以使用 Ctrl+Y 重做移动

**测试步骤（退出编辑模式）：**
5. 双击空白处或点击多边形外部

**预期结果（退出编辑模式）：**
- ✅ 顶点控制点消失
- ✅ 状态栏恢复正常显示
- ✅ 多边形保持编辑后的形状

---

### 5. 多边形顶点拖动编辑（画布）⭐ 核心功能

**测试步骤：**
1. 使用多边形工具创建一个多边形（3-6 个顶点）
2. 使用选择工具**双击**多边形

**预期结果（进入编辑模式）：**
- ✅ 状态栏显示"顶点编辑模式"
- ✅ 状态栏显示操作提示："拖动顶点修改位置"
- ✅ 状态栏显示退出提示："双击或点击空白处退出"
- ✅ 所有顶点显示为蓝色圆点（6px）
- ✅ 顶点中心显示白色编号（0, 1, 2...）

**测试步骤（拖动顶点）：**
3. 点击并拖动任意顶点

**预期结果（拖动中）：**
- ✅ 被拖动的顶点变为红色
- ✅ 多边形形状实时跟随鼠标更新
- ✅ 其他顶点保持蓝色

**测试步骤（完成拖动）：**
4. 释放鼠标

**预期结果（拖动完成）：**
- ✅ 顶点保持在新位置
- ✅ 顶点变回蓝色
- ✅ 可以使用 Ctrl+Z 撤销移动
- ✅ 可以使用 Ctrl+Y 重做移动

**测试步骤（退出编辑模式）：**
5. 双击空白处或点击多边形外部

**预期结果（退出编辑模式）：**
- ✅ 顶点控制点消失
- ✅ 状态栏恢复正常显示
- ✅ 多边形保持编辑后的形状

---

### 6. 多边形双击完成（Bug 修复）

**测试步骤：**
1. 使用多边形工具
2. 点击 5 个点创建顶点
3. **双击**完成多边形

**预期结果：**
- ✅ 多边形有且仅有 5 个顶点
- ✅ 最后一个顶点**没有重复**
- ✅ 多边形形状正确闭合

**测试方法验证：**
- 使用选择工具选中多边形
- 在属性面板查看"多边形顶点"
- 确认顶点数量正确（5 个，而不是 6 个）

---

### 6. 多边形双击完成（Bug 修复）

**测试步骤：**
1. 使用多边形工具
2. 点击 5 个点创建顶点
3. **双击**完成多边形

**预期结果：**
- ✅ 多边形有且仅有 5 个顶点
- ✅ 最后一个顶点**没有重复**
- ✅ 多边形形状正确闭合

**测试方法验证：**
- 使用选择工具选中多边形
- 在属性面板查看"多边形顶点"
- 确认顶点数量正确（5 个，而不是 6 个）

---

### 7. 综合测试：撤销/重做

**测试步骤：**
1. 创建一个矩形，修改宽度
2. 创建一个圆形，修改半径
3. 创建一个多边形，双击进入编辑模式，拖动一个顶点
4. 拖动多边形位置
5. 按 Ctrl+Z 四次撤销所有操作

**预期结果：**
- ✅ 第一次撤销：多边形回到拖动前的位置
- ✅ 第二次撤销：顶点回到拖动前的位置
- ✅ 第三次撤销：圆形半径恢复
- ✅ 第四次撤销：矩形宽度恢复

**继续测试：**
6. 按 Ctrl+Y 四次重做

**预期结果：**
- ✅ 所有修改按相反顺序重新应用
- ✅ 最终状态与步骤 4 完成时一致

---

### 7. 综合测试：撤销/重做

**测试步骤：**
1. 创建一个矩形，修改位置坐标 X
2. 修改矩形的宽度
3. 创建一个圆形，修改角度
4. 修改圆形的半径
5. 创建一个多边形，双击进入编辑模式，拖动一个顶点
6. 拖动多边形位置
7. 按 Ctrl+Z 六次撤销所有操作

**预期结果：**
- ✅ 第一次撤销：多边形回到拖动前的位置
- ✅ 第二次撤销：顶点回到拖动前的位置
- ✅ 第三次撤销：圆形半径恢复
- ✅ 第四次撤销：圆形角度恢复
- ✅ 第五次撤销：矩形宽度恢复
- ✅ 第六次撤销：矩形位置恢复

**继续测试：**
8. 按 Ctrl+Y 六次重做

**预期结果：**
- ✅ 所有修改按相反顺序重新应用
- ✅ 最终状态与步骤 6 完成时一致

---

### 8. 边界情况测试

#### 7.1 最小值测试
- 尝试输入宽度/高度/半径为 0.1m（最小值）
- **预期**：接受并应用

#### 7.2 负值测试
- 尝试输入宽度/高度/半径为负数
- **预期**：被限制为最小值 0.1m

#### 7.3 极端拖动测试
- 将顶点拖动到物体中心
- 将顶点拖动到画布边缘
- **预期**：位置正确更新，无崩溃

#### 7.4 旋转物体编辑测试
1. 创建多边形
2. 使用属性面板修改角度（例如 45°）
3. 双击进入顶点编辑模式
4. 拖动顶点
- **预期**：顶点正确跟随旋转坐标系

---

### 8. 边界情况测试

#### 8.1 最小值测试
- 尝试输入宽度/高度/半径为 0.1m（最小值）
- **预期**：接受并应用

#### 8.2 负值测试
- 尝试输入宽度/高度/半径为负数
- **预期**：被限制为最小值 0.1m

#### 8.3 坐标极值测试
- 尝试输入位置坐标为 100m、-100m
- **预期**：正确接受并移动到该位置

#### 8.4 角度测试
- 尝试输入角度为 0°、90°、180°、270°、360°、-45°
- **预期**：物体正确旋转到对应角度

#### 8.5 极端拖动测试
- 将顶点拖动到物体中心
- 将顶点拖动到画布边缘
- **预期**：位置正确更新，无崩溃

#### 8.6 旋转物体编辑测试
1. 创建多边形
2. 使用属性面板修改角度（例如 45°）
3. 双击进入顶点编辑模式
4. 拖动顶点
- **预期**：顶点正确跟随旋转坐标系

---

### 9. 性能测试

**测试步骤：**
1. 创建一个 10 个顶点的复杂多边形
2. 双击进入编辑模式
3. 快速连续拖动多个顶点
4. 快速修改多个属性值（位置、角度、尺寸）

**预期结果：**
- ✅ 渲染流畅，无卡顿
- ✅ 顶点跟随鼠标实时更新
- ✅ 属性修改立即生效
- ✅ 没有明显延迟

---

## 📊 测试结果

### 测试环境
- **操作系统**: Windows
- **浏览器**: Chrome/Edge
- **开发服务器**: Vite (npm run dev)
- **测试日期**: 2025-10-14

### 测试状态

- [ ] 位置和角度编辑
- [ ] 矩形尺寸编辑
- [ ] 圆形半径编辑
- [ ] 多边形顶点编辑（属性面板）
- [ ] 多边形顶点拖动编辑（画布）
- [ ] 多边形双击完成（Bug 修复）
- [ ] 综合撤销/重做测试
- [ ] 边界情况测试
- [ ] 性能测试

### 发现的问题

*待测试后填写*

---

## 🎓 使用技巧

### 精确定位
1. 使用属性面板的"位置坐标"输入框精确设置物体位置
2. 使用"旋转角度"输入框精确设置物体旋转
3. 配合鼠标拖动可以先粗调，再用输入框精调

### 快速编辑顶点
1. 双击多边形 → 进入编辑模式
2. 拖动顶点 → 调整形状
3. 点击空白处 → 退出编辑模式

### 精确编辑
- 使用属性面板输入框可以输入精确的数值
- 使用画布拖动可以直观调整位置
- 两种方式可以配合使用

### 撤销保护
- 所有编辑操作都支持撤销
- 如果不满意，随时可以 Ctrl+Z
- 最多可以撤销 50 步

---

## 📝 注意事项

1. **位置坐标是世界坐标**：相对于画布原点 (0, 0)
2. **顶点坐标是局部坐标**：相对于物体中心，而不是世界坐标
3. **旋转影响**：如果物体旋转了，顶点坐标系也会旋转
4. **角度单位**：属性面板使用度（°），内部存储使用弧度
5. **最小值限制**：宽度/高度/半径最小为 0.1m
6. **拖动精度**：顶点点击半径为 0.3m，确保精确选中

---

## 🚀 下一步

测试完成后：
1. 提交 git commit
2. 更新用户文档
3. 发布 v2.0.0 版本
