# 画布大小调整功能

## 📐 功能概述

v2.1.0 版本新增了画布大小调整功能，允许用户根据需要动态调整设计画布的尺寸。

## ✨ 功能特性

### 宽度调整
- **范围**: 600 - 2000 像素
- **步进**: 50 像素
- **默认值**: 1000 像素
- **实时预览**: 拖动滑块即时更新

### 高度调整
- **范围**: 400 - 1500 像素
- **步进**: 50 像素
- **默认值**: 700 像素
- **实时预览**: 拖动滑块即时更新

### UI 集成
- **位置**: 右侧属性面板 → 视图设置区域
- **显示**: 实时显示当前画布尺寸
- **重置**: "重置视图" 按钮可恢复默认尺寸

## 🎯 使用方法

### 调整画布宽度
1. 在右侧属性面板找到 **"视图设置"** 区域
2. 拖动 **"画布宽度 (px)"** 滑块
3. 画布宽度实时更新，当前值显示在标签上
4. 状态栏显示 "画布宽度已调整为 XXX px"

### 调整画布高度
1. 拖动 **"画布高度 (px)"** 滑块
2. 画布高度实时更新
3. 状态栏显示 "画布高度已调整为 XXX px"

### 恢复默认尺寸
点击 **"重置视图"** 按钮，画布将恢复到默认的 1000×700 像素。

## 💡 使用场景

### 1. 大型场景设计
```
宽度: 1800px
高度: 1200px
用途: 设计大型关卡，需要更多可视空间
```

### 2. 垂直关卡
```
宽度: 800px
高度: 1400px
用途: 设计垂直向上的跳跃关卡
```

### 3. 水平关卡
```
宽度: 1800px
高度: 600px
用途: 设计横向卷轴关卡
```

### 4. 小尺寸预览
```
宽度: 600px
高度: 400px
用途: 快速预览全局布局
```

### 5. 高分辨率设计
```
宽度: 2000px
高度: 1500px
用途: 精细设计，最大画布空间
```

## 🔧 技术实现

### HTML 滑块控件
```html
<div class="property-field">
  <label>画布宽度 (px): <span id="canvas-width-value">1000</span></label>
  <input type="range" id="canvas-width-slider" 
         min="600" max="2000" value="1000" step="50">
  <div class="hint">600-2000 像素</div>
</div>

<div class="property-field">
  <label>画布高度 (px): <span id="canvas-height-value">700</span></label>
  <input type="range" id="canvas-height-slider" 
         min="400" max="1500" value="700" step="50">
  <div class="hint">400-1500 像素</div>
</div>
```

### TypeScript 事件处理
```typescript
// 画布宽度调整
canvasWidthSlider?.addEventListener('input', (e) => {
  const value = parseInt((e.target as HTMLInputElement).value);
  this.canvas.width = value;
  if (canvasWidthValue) canvasWidthValue.textContent = value.toString();
  this.render();
  this.updateStatus('画布宽度已调整为 ' + value + 'px');
});

// 画布高度调整
canvasHeightSlider?.addEventListener('input', (e) => {
  const value = parseInt((e.target as HTMLInputElement).value);
  this.canvas.height = value;
  if (canvasHeightValue) canvasHeightValue.textContent = value.toString();
  this.render();
  this.updateStatus('画布高度已调整为 ' + value + 'px');
});
```

### 重置功能增强
```typescript
// 重置视图按钮现在也会重置画布大小
resetBtn?.addEventListener('click', () => {
  // 重置画布大小
  this.canvas.width = 1000;
  this.canvas.height = 700;
  if (canvasWidthSlider) canvasWidthSlider.value = '1000';
  if (canvasWidthValue) canvasWidthValue.textContent = '1000';
  if (canvasHeightSlider) canvasHeightSlider.value = '700';
  if (canvasHeightValue) canvasHeightValue.textContent = '700';
  
  // 重置其他视图参数 (PPM, 原点)
  // ...
});
```

## 📊 尺寸限制说明

### 最小尺寸
- **宽度**: 600px - 确保工具栏和基本UI可用
- **高度**: 400px - 确保至少显示部分场景

### 最大尺寸
- **宽度**: 2000px - 平衡性能和可用性
- **高度**: 1500px - 避免过度占用屏幕空间

### 为什么有这些限制？
1. **性能考虑**: 过大的画布会影响渲染性能
2. **内存限制**: Canvas 尺寸影响内存占用
3. **用户体验**: 过小的画布难以操作
4. **屏幕兼容**: 适配常见显示器分辨率

## 🎨 与其他功能的配合

### 与 PPM 缩放配合
```
场景: 需要显示更大的物理区域
方法: 
  1. 增大画布尺寸 (如 1800×1200)
  2. 降低 PPM 值 (如 15)
结果: 可以在画布上看到更大的物理空间
```

### 与原点偏移配合
```
场景: 设计偏向一侧的关卡
方法:
  1. 调整画布为横向 (1800×600)
  2. 偏移原点到左侧 (X = -10)
结果: 更多空间用于右侧关卡设计
```

### 与物理预览配合
```
场景: 观察大型场景的物理效果
方法:
  1. 增大画布尺寸
  2. 启动物理预览
结果: 更好地观察物体运动轨迹
```

## ⚙️ 实现细节

### 代码位置
```
文件: index.html
行数: ~140-152 (HTML 滑块控件)

文件: src/main.ts
行数: ~318-399 (setupViewControls 方法)
```

### 修改统计
```
index.html:  +12 行 (新增滑块控件)
src/main.ts: +20 行 (事件处理和重置逻辑)
总计:        +32 行
```

### 依赖关系
- ✅ 无新增依赖
- ✅ 使用标准 Canvas API
- ✅ 与现有视图控制系统集成

## 🧪 测试建议

### 功能测试
- [ ] 拖动宽度滑块，画布宽度实时变化
- [ ] 拖动高度滑块，画布高度实时变化
- [ ] 数值显示正确更新
- [ ] 状态栏消息正确显示
- [ ] 重置按钮恢复默认尺寸
- [ ] 画布内容正确重新渲染

### 边界测试
- [ ] 设置最小尺寸 (600×400)
- [ ] 设置最大尺寸 (2000×1500)
- [ ] 极端比例 (2000×400)
- [ ] 极端比例 (600×1500)

### 兼容性测试
- [ ] 创建物体后调整画布
- [ ] 选中物体时调整画布
- [ ] 预览模式下调整画布
- [ ] 撤销/重做功能不受影响

### 性能测试
- [ ] 大画布 (2000×1500) 性能正常
- [ ] 大画布 + 多物体 (50+) 性能可接受
- [ ] 调整画布时无明显卡顿

## 💡 使用技巧

### 技巧 1: 宽高比固定
如果你需要特定的宽高比（如 16:9），可以这样计算：
```
16:9 比例示例:
- 1600×900
- 1280×720
- 1920×1080 (超出范围，使用 2000×1125)
```

### 技巧 2: 适配屏幕
根据你的显示器分辨率调整：
```
1920×1080 显示器: 建议 1400×900 画布
2560×1440 显示器: 建议 1800×1200 画布
3840×2160 显示器: 建议 2000×1400 画布
```

### 技巧 3: 关卡类型优化
```
跳跃关卡: 800×1200 (竖向)
赛车关卡: 1800×600 (横向)
平台关卡: 1600×800 (宽屏)
战斗关卡: 1000×1000 (正方形)
```

### 技巧 4: 导出前调整
在导出 Box2D JSON 之前，调整画布到合适的尺寸以获得最佳预览效果。

## 🔮 未来改进

### 可能的增强
- [ ] 保存画布尺寸到文件
- [ ] 预设尺寸快捷按钮 (16:9, 4:3, 1:1)
- [ ] 直接输入数值 (不只是滑块)
- [ ] 画布尺寸历史记录
- [ ] 自动适配浏览器窗口

### 高级功能
- [ ] 多画布支持
- [ ] 画布缩略图导航
- [ ] 画布分屏对比
- [ ] 响应式画布（自动调整）

## 📚 相关文档

- `VIEW_CONTROLS_GUIDE.md` - 视图控制完整指南
- `QUICK_REFERENCE.md` - 快速参考（含画布调整）
- `USER_GUIDE.md` - 用户手册

## ✅ 功能状态

- ✅ **已实现**: 画布宽度调整
- ✅ **已实现**: 画布高度调整
- ✅ **已实现**: 实时数值显示
- ✅ **已实现**: 重置功能集成
- ✅ **已测试**: 基本功能正常
- ✅ **已文档化**: 使用说明完整

---

**功能版本**: v2.1.0  
**添加日期**: 2025-10-14  
**状态**: ✅ 生产就绪
